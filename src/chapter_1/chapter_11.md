# Работа с файловой системой 

В Go существует несколько встроенных пакетов для работы с файловой системой. Наиболее важный и часто используемый пакет — **`os`**, который предоставляет функции для создания, чтения, записи и удаления файлов, а также для работы с директориями и манипуляции с путями. В этом уроке мы рассмотрим основные возможности работы с файлами и каталогами в Go.

### Открытие и чтение файлов

Для открытия файлов в Go используется функция **`os.Open`**, которая возвращает дескриптор файла и ошибку. Файл может быть прочитан с помощью пакета **`io/ioutil`** или **`bufio`**.

#### Пример:

```go
package main

import (
	"fmt"
	"io/ioutil"
	"os"
)

func main() {
	// Открываем файл
	file, err := os.Open("example.txt")
	if err != nil {
		fmt.Println("Ошибка при открытии файла:", err)
		return
	}
	defer file.Close()

	// Чтение содержимого файла
	content, err := ioutil.ReadAll(file)
	if err != nil {
		fmt.Println("Ошибка при чтении файла:", err)
		return
	}

	fmt.Println("Содержимое файла:")
	fmt.Println(string(content))
}
```

- **`os.Open`** открывает файл в режиме только для чтения.
- **`ioutil.ReadAll`** читает всё содержимое файла в один вызов и возвращает его как байтовый срез.

### Запись данных в файл

Для записи данных в файл используйте функцию **`os.Create`** или **`os.OpenFile`**. Первый создаёт новый файл или перезаписывает существующий, а второй предоставляет гибкий способ открытия файлов с разными режимами.

#### Пример записи файла:

```go
package main

import (
	"fmt"
	"os"
)

func main() {
	// Создаем новый файл или перезаписываем существующий
	file, err := os.Create("output.txt")
	if err != nil {
		fmt.Println("Ошибка при создании файла:", err)
		return
	}
	defer file.Close()

	// Записываем строку в файл
	_, err = file.WriteString("Привет, мир!\n")
	if err != nil {
		fmt.Println("Ошибка при записи в файл:", err)
		return
	}

	fmt.Println("Запись в файл успешна!")
}
```

- **`os.Create`** создаёт новый файл (или перезаписывает существующий).
- **`file.WriteString`** записывает строку в файл.

### Чтение и запись через буферы

Если вам нужно более контролируемое чтение или запись (например, построчное чтение), вы можете использовать **`bufio.Scanner`** для чтения или **`bufio.Writer`** для буферизированной записи.

#### Пример построчного чтения:

```go
package main

import (
	"bufio"
	"fmt"
	"os"
)

func main() {
	file, err := os.Open("example.txt")
	if err != nil {
		fmt.Println("Ошибка при открытии файла:", err)
		return
	}
	defer file.Close()

	scanner := bufio.NewScanner(file)
	for scanner.Scan() {
		fmt.Println(scanner.Text()) // Печатает каждую строку файла
	}

	if err := scanner.Err(); err != nil {
		fmt.Println("Ошибка при чтении файла:", err)
	}
}
```

#### Пример буферизированной записи:

```go
package main

import (
	"bufio"
	"fmt"
	"os"
)

func main() {
	file, err := os.Create("buffered_output.txt")
	if err != nil {
		fmt.Println("Ошибка при создании файла:", err)
		return
	}
	defer file.Close()

	writer := bufio.NewWriter(file)
	writer.WriteString("Первая строка\n")
	writer.WriteString("Вторая строка\n")

	// Обязательно вызываем Flush, чтобы записать буфер в файл
	writer.Flush()

	fmt.Println("Запись в файл завершена!")
}
```

### Работа с директориями

Для работы с директориями Go предоставляет функции **`os.Mkdir`**, **`os.Remove`**, **`os.Rename`** и другие. Эти функции позволяют создавать, удалять и переименовывать директории.

#### Пример создания директории:

```go
package main

import (
	"fmt"
	"os"
)

func main() {
	// Создаём директорию с правами доступа 0755
	err := os.Mkdir("new_directory", 0755)
	if err != nil {
		fmt.Println("Ошибка при создании директории:", err)
		return
	}

	fmt.Println("Директория создана!")
}
```

#### Пример удаления файла или директории:

```go
package main

import (
	"fmt"
	"os"
)

func main() {
	// Удаляем файл или пустую директорию
	err := os.Remove("output.txt")
	if err != nil {
		fmt.Println("Ошибка при удалении файла/директории:", err)
		return
	}

	fmt.Println("Файл/директория удалены!")
}
```

### Получение информации о файлах

С помощью функции **`os.Stat`** можно получить информацию о файле или директории, например, размер, права доступа, время изменения и т.д.

#### Пример получения информации о файле:

```go
package main

import (
	"fmt"
	"os"
)

func main() {
	info, err := os.Stat("example.txt")
	if err != nil {
		fmt.Println("Ошибка при получении информации о файле:", err)
		return
	}

	fmt.Println("Имя файла:", info.Name())
	fmt.Println("Размер файла:", info.Size())
	fmt.Println("Права доступа:", info.Mode())
	fmt.Println("Время изменения:", info.ModTime())
}
```

### Полезные задания

1. **Задание на чтение файлов:**
   Напишите программу, которая читает файл построчно и выводит только те строки, которые содержат определённое ключевое слово.

2. **Задание на запись файлов:**
   Напишите программу, которая записывает в файл строки, введённые пользователем в консоль, пока не будет введена пустая строка.

3. **Работа с директориями:**
   Напишите программу, которая создаёт несколько вложенных директорий и файлов в них, а затем рекурсивно удаляет их.

4. **Задание на буферизированную запись:**
   Создайте программу, которая записывает в файл большой объём данных через буфер, но вызывает `Flush` только после завершения записи.

5. **Задание на информацию о файлах:**
   Напишите программу, которая получает информацию обо всех файлах в указанной директории и выводит их размер, права доступа и дату последнего изменения.
